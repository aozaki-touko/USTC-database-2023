# hw1

S表

| **SNO** | **SNAME** | **STATUES** | **CITY** |
| ------- | --------- | ----------- | -------- |
| S1      | 精益      | 20          | 天津     |
| S2      | 盛锡      | 10          | 北京     |
| S3      | 东方红    | 30          | 北京     |
| S4      | 丰泰盛    | 20          | 天津     |
| S5      | 为民      | 30          | 上海     |

P表

| **PNO** | **PNAME** | **COLOR** | **WEIGHT** |
| ------- | --------- | --------- | ---------- |
| P1      | 螺母      | 红        | 12         |
| P2      | 螺栓      | 绿        | 17         |
| P3      | 螺丝刀    | 蓝        | 14         |
| P4      | 螺丝刀    | 红        | 14         |
| P5      | 凸轮      | 蓝        | 40         |
| P6      | 齿轮      | 红        | 30         |

J表

| **JNO** | **PNAME** | **CITY** |
| ------- | --------- | -------- |
| J1      | 三建      | 北京     |
| J2      | 一汽      | 长春     |
| J3      | 弹簧厂    | 天津     |
| J4      | 造船厂    | 天津     |
| J5      | 机车厂    | 唐山     |
| J6      | 无线电厂  | 常州     |
| J7      | 半导体厂  | 南京     |

SPJ表

| **SNO** | **PNO** | **JNO** | **QTY** |
| ------- | ------- | ------- | ------- |
| S1      | P1      | J1      | 200     |
| S1      | P1      | J3      | 100     |
| S1      | P1      | J4      | 700     |
| S1      | P2      | J2      | 100     |
| S2      | P3      | J1      | 400     |
| S2      | P3      | J2      | 200     |
| S2      | P3      | J4      | 500     |
| S2      | P3      | J5      | 400     |
| S2      | P5      | J1      | 400     |
| S2      | P5      | J2      | 100     |
| S3      | P1      | J1      | 200     |
| S3      | P3      | J1      | 200     |
| S4      | P5      | J1      | 100     |
| S4      | P6      | J3      | 300     |
| S4      | P6      | J4      | 200     |
| S5      | P2      | J4      | 100     |
| S5      | P3      | J1      | 200     |
| S5      | P6      | J2      | 200     |
| S5      | P6      | J4      | 50      |



设有一个 SPJ 数据库，包括S、P、J及 SPJ 个关系模式：

S(SNO,SNAME,STATUS,CITY) P(PNO,PNAME,COLOR,WEIGHT)

J(JNO,JNAME,CITY) SPJ(SNO,PNO,JNO,QTY)

供应商表S由供应商代码（SNO）、供应商姓名（SNAME）、供应商状态（STATUS）、供应商所在城市（CITY）组成。

零件表P由零件代码（PNO）、零件名（PNO）、颜色（COLOR）、重量（WEIGHT）组成。

工程项目表J由工程项目代码（JNO）、工程项目名（JNAME）、工程项目所在城市（CITY）组成。

供应情况表SPJ由供应商代码（SNO）、零件代码（PNO）、工程项目代码（JNO）、供应数量（QTY）组成， 表示某供应商供应某种零件给某工程项目的数量为 QTY。今有若干数据。

**试用关系代数完成如下查询：**

**(1) 求供应工程J1 零件的供应商号码 SNO；**

**(2) 求供应工程J1 零件 P1 的供应商号码 SNO**

**(3) 求供应工程J1零件为红色的供应商号码SNO**

**(4) 求没有使用天津供应商生产的 红色零件的工程号JNO**

**(5) 求至少用了供应商S1所供应的全部零件的工程号JNO。**



1. 只要选择J1项，再做SNO的投影就行

   $\pi_{sno}(\sigma_{jno=j1}(SPJ))$

2. 和上面一样，只需要选择J1和P1，再做SNO投影

   $\pi_{sno}(\sigma_{(jno=j1)\and(pno=p1)}(SPJ))$

3. 想把P表和SPJ表连接起来，这样得到的表就有了color这一信息，再选择J1和红就行

   $\pi_{sno}(\sigma_{(jno=j1)\and(COLOR=红)}(SPJ\Join P))$

4. 先求使用了天津供应商生产的红色零件的工程号

   $\pi_{jno}(\sigma_{(CITY=天津)\and(COLOR=红)}(S\Join SPJ\Join P))$

   在用J表减去即可

   故答案为

   $\pi_{jno}(J)-\pi_{jno}(\sigma_{(CITY=天津)\and(COLOR=红)}(S\Join SPJ\Join P))$

5. 先求S1提供的所有零件

   $\pi_{pno}(\sigma_{sno=s1}(SPJ))$

   再用JNO和PNO的投影除以这个表

   $\pi_{JNO,PNO}(SPJ)\div \pi_{pno}(\sigma_{sno=s1}(SPJ))$